<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Potential Optimizers • rco</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Potential Optimizers">
<meta property="og:description" content="rco">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rco</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Optimizers
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/opt-common-subexpr.html">Common Subexpression Elimination</a>
    </li>
    <li>
      <a href="../articles/opt-cond-thread.html">Conditional Threading</a>
    </li>
    <li>
      <a href="../articles/opt-constant-folding.html">Constant Folding</a>
    </li>
    <li>
      <a href="../articles/opt-constant-propagation.html">Constant Propagation</a>
    </li>
    <li>
      <a href="../articles/opt-dead-code.html">Dead Code Elimination</a>
    </li>
    <li>
      <a href="../articles/opt-dead-expr.html">Dead Expression Elimination</a>
    </li>
    <li>
      <a href="../articles/opt-dead-store.html">Dead Store Elimination</a>
    </li>
    <li>
      <a href="../articles/opt-loop-invariant.html">Loop-invariant Code Motion</a>
    </li>
    <li>
      <a href="../articles/opt-memory-alloc.html">Memory Allocation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/contributing-an-optimizer.html">Contributing an Optimizer</a>
    </li>
    <li>
      <a href="../articles/potential-optimizers.html">Potential Optimizers</a>
    </li>
    <li>
      <a href="../articles/docker-readme.html">Docker Image</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jcrodriguez1989/rco/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="potential-optimizers_files/header-attrs-2.5/header-attrs.js"></script><link href="potential-optimizers_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="potential-optimizers_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Potential Optimizers</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jcrodriguez1989/rco/blob/master/vignettes/potential-optimizers.Rmd"><code>vignettes/potential-optimizers.Rmd</code></a></small>
      <div class="hidden name"><code>potential-optimizers.Rmd</code></div>

    </div>

    
    
<div id="potential-optimizers" class="section level1">
<h1 class="hasAnchor">
<a href="#potential-optimizers" class="anchor"></a>Potential optimizers</h1>
<div id="inline-expansion" class="section level2">
<h2 class="hasAnchor">
<a href="#inline-expansion" class="anchor"></a>Inline Expansion</h2>
<div id="idea" class="section level3">
<h3 class="hasAnchor">
<a href="#idea" class="anchor"></a>Idea</h3>
<p>Replacing a function call with the body of the called function is called “inline expansion”. This eliminates the function calling overhead and also the overhead of return call from a function. It also saves the overhead of variables push/pop on the stack while function calling.</p>
</div>
<div id="code-examples" class="section level3">
<h3 class="hasAnchor">
<a href="#code-examples" class="anchor"></a>Code Examples</h3>
<div id="unoptimized-code" class="section level4">
<h4 class="hasAnchor">
<a href="#unoptimized-code" class="anchor"></a>Unoptimized Code</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cubed</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">x</span> <span class="op">*</span> <span class="va">x</span> <span class="op">*</span> <span class="va">x</span>
<span class="op">}</span>

<span class="va">inline</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">to_cubes</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">to_cubes</span> <span class="op">&lt;-</span> <span class="va">to_cubes</span> <span class="op">+</span> <span class="fu">cubed</span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="proposed-optimized-code" class="section level4">
<h4 class="hasAnchor">
<a href="#proposed-optimized-code" class="anchor"></a>Proposed Optimized Code</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">inline_opt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">to_cubes</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">to_cubes</span> <span class="op">&lt;-</span> <span class="va">to_cubes</span> <span class="op">+</span> <span class="op">(</span><span class="va">i</span> <span class="op">*</span> <span class="va">i</span> <span class="op">*</span> <span class="va">i</span><span class="op">)</span> <span class="co"># function inlined</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
</div>
</div>
<div id="benchmark" class="section level3">
<h3 class="hasAnchor">
<a href="#benchmark" class="anchor"></a>Benchmark</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span>
<span class="fu">autoplot</span><span class="op">(</span><span class="fu">microbenchmark</span><span class="op">(</span><span class="fu">inline</span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="fu">inline_opt</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="potential-optimizers_files/figure-html/inline_expansion_benchmark-1.png" width="700"></p>
</div>
</div>
<div id="memory-pre-allocation" class="section level2">
<h2 class="hasAnchor">
<a href="#memory-pre-allocation" class="anchor"></a>Memory Pre-Allocation</h2>
<div id="idea-1" class="section level3">
<h3 class="hasAnchor">
<a href="#idea-1" class="anchor"></a>Idea</h3>
<p>As a general rule of thumb, in any programming language, we should undertake memory management as much as possible. When we grow a vector inside a loop, the vector asks the processor for extra space in between the running program and then proceeds, once it gets the required memory. This process is repeated for every iteration of the loop. Thus we should pre-allocate the required memory to a vector to avoid such delays.</p>
</div>
<div id="code-examples-1" class="section level3">
<h3 class="hasAnchor">
<a href="#code-examples-1" class="anchor"></a>Code Examples</h3>
<div id="unoptimized-code-1" class="section level4">
<h4 class="hasAnchor">
<a href="#unoptimized-code-1" class="anchor"></a>Unoptimized Code</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mem_alloc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">vec</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">vec</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">i</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="proposed-optimized-code-1" class="section level4">
<h4 class="hasAnchor">
<a href="#proposed-optimized-code-1" class="anchor"></a>Proposed Optimized Code</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mem_alloc_opt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span>length <span class="op">=</span> <span class="va">n</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">vec</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">i</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
</div>
</div>
<div id="benchmark-1" class="section level3">
<h3 class="hasAnchor">
<a href="#benchmark-1" class="anchor"></a>Benchmark</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100000</span>
<span class="fu">autoplot</span><span class="op">(</span><span class="fu">microbenchmark</span><span class="op">(</span><span class="fu">mem_alloc</span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="fu">mem_alloc_opt</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="potential-optimizers_files/figure-html/pre_allocate_benchmark-1.png" width="700"></p>
</div>
</div>
<div id="vectorization" class="section level2">
<h2 class="hasAnchor">
<a href="#vectorization" class="anchor"></a>Vectorization</h2>
<div id="idea-2" class="section level3">
<h3 class="hasAnchor">
<a href="#idea-2" class="anchor"></a>Idea</h3>
<p>A golden rule in R programming is to access the underlying C/Fortran routines as much as possible; the fewer R function calls required to achieve this, the better. Many R functions are therefore vectorized, that is, the function’s inputs and/or outputs naturally work with vectors, reducing the number of function calls required.</p>
</div>
<div id="code-examples-2" class="section level3">
<h3 class="hasAnchor">
<a href="#code-examples-2" class="anchor"></a>Code Examples</h3>
<div id="unoptimized-code-2" class="section level4">
<h4 class="hasAnchor">
<a href="#unoptimized-code-2" class="anchor"></a>Unoptimized Code</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">non_vectorized</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
  <span class="va">v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq.int</a></span><span class="op">(</span><span class="va">n</span> <span class="op">+</span> <span class="fl">2</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">1000</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">v1</span><span class="op">)</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">res</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">v1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">v2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="proposed-optimized-code-2" class="section level4">
<h4 class="hasAnchor">
<a href="#proposed-optimized-code-2" class="anchor"></a>Proposed Optimized Code</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vectorized</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
  <span class="va">v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq.int</a></span><span class="op">(</span><span class="va">n</span> <span class="op">+</span> <span class="fl">2</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">1000</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">v1</span> <span class="op">+</span> <span class="va">v2</span>
<span class="op">}</span></code></pre></div>
</div>
</div>
<div id="benchmark-2" class="section level3">
<h3 class="hasAnchor">
<a href="#benchmark-2" class="anchor"></a>Benchmark</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10000</span>
<span class="fu">autoplot</span><span class="op">(</span><span class="fu">microbenchmark</span><span class="op">(</span><span class="fu">non_vectorized</span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="fu">vectorized</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="potential-optimizers_files/figure-html/vectorized_benchmark-1.png" width="700"></p>
</div>
</div>
<div id="efficient-column-extraction" class="section level2">
<h2 class="hasAnchor">
<a href="#efficient-column-extraction" class="anchor"></a>Efficient Column Extraction</h2>
<div id="idea-3" class="section level3">
<h3 class="hasAnchor">
<a href="#idea-3" class="anchor"></a>Idea</h3>
<p>The idea would be to replace the different one-column extraction alternatives by the much faster <code>.subset2</code> call alternative.</p>
</div>
<div id="benchmark-3" class="section level3">
<h3 class="hasAnchor">
<a href="#benchmark-3" class="anchor"></a>Benchmark</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">autoplot</span><span class="op">(</span><span class="fu">microbenchmark</span><span class="op">(</span>
  <span class="va">mtcars</span><span class="op">[</span>, <span class="fl">11</span><span class="op">]</span>,
  <span class="va">mtcars</span><span class="op">$</span><span class="va">carb</span>,
  <span class="va">mtcars</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>,
  <span class="va">mtcars</span><span class="op">[[</span><span class="fl">11</span><span class="op">]</span><span class="op">]</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/base-internal.html">.subset2</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fl">11</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="potential-optimizers_files/figure-html/col_ext_benchmark-1.png" width="700"></p>
</div>
<div id="drawbacks" class="section level3">
<h3 class="hasAnchor">
<a href="#drawbacks" class="anchor"></a>Drawbacks</h3>
<ol style="list-style-type: decimal">
<li><p>For some R classes, the <code>[[ ]]</code> operator and <code>.subset</code> work differently. For instance, they seem to be equivalent for <code>data.frame</code> but are not the same for <code>matrix</code> class.</p></li>
<li><p>Moreover, both <code>[[ ]]</code> and <code>.subset2</code> are functions and in R, any function can be overwritten. Thus the above optimization can be made to fail just by redefining, say, the the <code>.subset2</code> function.</p></li>
</ol>
</div>
</div>
<div id="efficient-value-extraction" class="section level2">
<h2 class="hasAnchor">
<a href="#efficient-value-extraction" class="anchor"></a>Efficient Value Extraction</h2>
<div id="idea-4" class="section level3">
<h3 class="hasAnchor">
<a href="#idea-4" class="anchor"></a>Idea</h3>
<p>The idea would be to replace the different one-value extraction alternatives by the much faster <code>.subset2</code> call alternative.</p>
</div>
<div id="benchmark-4" class="section level3">
<h3 class="hasAnchor">
<a href="#benchmark-4" class="anchor"></a>Benchmark</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">autoplot</span><span class="op">(</span><span class="fu">microbenchmark</span><span class="op">(</span>
  <span class="va">mtcars</span><span class="op">[</span><span class="fl">32</span>, <span class="fl">11</span><span class="op">]</span>,
  <span class="va">mtcars</span><span class="op">$</span><span class="va">carb</span><span class="op">[</span><span class="fl">32</span><span class="op">]</span>,
  <span class="va">mtcars</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">32</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>,
  <span class="va">mtcars</span><span class="op">[[</span><span class="fl">11</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">32</span><span class="op">]</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/base-internal.html">.subset2</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fl">11</span><span class="op">)</span><span class="op">[</span><span class="fl">32</span><span class="op">]</span>,
  times <span class="op">=</span> <span class="fl">1000L</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="potential-optimizers_files/figure-html/val_ext_benchmark-1.png" width="700"></p>
</div>
<div id="drawback" class="section level3">
<h3 class="hasAnchor">
<a href="#drawback" class="anchor"></a>Drawback</h3>
<ol style="list-style-type: decimal">
<li><p>For some R classes, the <code>[[ ]]</code> operator and <code>.subset</code> work differently. For instance, they seem to be equivalent for <code>data.frame</code> but are not the same for <code>matrix</code> class.</p></li>
<li><p>Moreover, both <code>[[ ]]</code> and <code>.subset2</code> are functions and in R, any function can be overwritten. Thus the above optimization can be made to fail just by redefining, say, the <code>.subset2</code> function.</p></li>
</ol>
<!-- ## External packages that can be explored for further speed-ups --><!-- ### For efficient programming --><!-- * **compiler** --><!-- * **memoise** --><!-- ### For Efficient Data Carpentry --><!-- * **tibble** --><!-- * **tidyr** --><!-- * **stringr** --><!-- * **readr** --><!-- * **dplyr** --><!-- * **data.table**   --><!-- ### For efficient input/output --><!-- * **rio** --><!-- * **readr** --><!-- * **data.table** --><!-- * **feather** --><!-- ### For efficient Optimization --><!-- * **profvis** --><!-- * **Rcpp** --><!-- ### For efficient set-up and hardware --><!-- * **benchmarkme** --><!-- ### For efficient collaboration --><!-- * **lubridate** --><!-- ### For efficient workflow --><!-- * **DiagrammeR** --><!-- ### Some additional comments --><!-- * `if` is faster than `ifelse`, but the speed boost of `if` isn't particularly interesting since it isn't something that can easily be harnessed through vectorization. That is to say, `if` is only advantageous over `ifelse` when the *cond/test argument is of length 1*. --><!-- * A factor is just a vector of integers with associated levels. Occasionally we want to convert a factor into its numerical equivalent. The most efficient way of doing this (especially for long factors) is: --><!--   `as.numeric(levels(f))[f]` --><!-- * The non-vectorised version of R logical vectors, `&&` and `||`, only executes the second component if needed. This is efficient and leads to neater. Care must be taken not to use `&&` or `||` on vectors since it only evaluates the first element of the vector, giving the incorrect answer. -->
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Juan Cruz Rodriguez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
